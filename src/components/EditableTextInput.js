import './EditableTextInput.css'
import {useRef, useState} from "react";
function EditableTextInput({initialText, placeholder, onEdited, canEmpty = true}) {
    const elementRef = useRef(null);
    const inputRef = useRef(null);
    const [editing, setEditing] = useState(false);
    const [currentText, setCurrentText] = useState(initialText);
    return <div
        ref={elementRef}
        className={'editable-text-input'}
    >
        {
            editing &&
            <>
                <input
                    ref={inputRef}
                    style={{
                        fontSize: '1em',
                        color: 'var(--text-color)',
                        background: 'none',
                        border: 'none',
                        borderBottom: '1px solid var(--text-color)'
                    }}
                    type={'text'}
                    placeholder={placeholder}
                    defaultValue={`${currentText || ''}`}
                />
                <div className={'editable-input-buttons'}>
                    <svg
                        onClick={(event) => {
                            if (!canEmpty && !inputRef.current.value) {
                                inputRef.current.style.borderBottom = '1px solid red';
                                inputRef.current.style.color = 'red';
                                setTimeout(() => {
                                    inputRef.current.style.color = 'var(--text-color)';
                                    inputRef.current.style.borderBottom = '1px solid var(--text-color)'
                                }, 1000);
                                return;
                            }
                            setCurrentText(inputRef.current.value);
                            onEdited(inputRef.current.value || '');
                            setEditing(false);
                        }}
                        style={{
                            height: '100%',
                        }}
                        xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 32 32">
                        <path d="M13.071,24.358c-0.497,0-0.962-0.246-1.242-0.658c-2.339-3.45-4.751-5.873-7.373-7.405 c-0.715-0.418-0.956-1.337-0.538-2.052c0.417-0.715,1.336-0.958,2.052-0.538c2.529,1.478,4.856,3.627,7.071,6.539 c4.261-6.008,9.283-10.838,14.952-14.375c0.705-0.438,1.628-0.225,2.066,0.479c0.438,0.703,0.225,1.628-0.479,2.066 c-5.935,3.702-10.925,8.697-15.258,15.27c-0.276,0.419-0.742,0.672-1.243,0.675C13.077,24.358,13.074,24.358,13.071,24.358z"></path>
                    </svg>
                    <svg
                        onClick={(event) => {
                            setEditing(false);
                        }}
                        style={{
                            height: '100%',
                        }}
                        xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 32 32">
                        <path d="M25.372,23.279c-2.507-1.79-4.909-3.792-7.238-6.001c2.602-2.673,5.117-5.613,7.566-8.878 c0.497-0.663,0.362-1.604-0.3-2.101c-0.664-0.495-1.603-0.362-2.101,0.3c-2.366,3.155-4.792,5.993-7.3,8.57 c-2.507-2.577-4.934-5.415-7.3-8.57C8.203,5.938,7.264,5.805,6.6,6.3C5.938,6.797,5.803,7.737,6.3,8.4 c2.449,3.265,4.964,6.205,7.567,8.878c-2.329,2.209-4.731,4.211-7.238,6.001c-0.674,0.481-0.83,1.418-0.349,2.093 C6.572,25.782,7.033,26,7.501,26c0.302,0,0.606-0.091,0.871-0.279c2.646-1.89,5.177-4.003,7.628-6.333 c2.451,2.331,4.982,4.443,7.628,6.333C23.893,25.909,24.197,26,24.499,26c0.468,0,0.929-0.219,1.222-0.628 C26.202,24.697,26.046,23.761,25.372,23.279z"></path>
                    </svg>
                </div>
            </>
        }
        {
            !editing &&
            <>
                <div
                    style={{
                        opacity: currentText ? '' : '50%',
                        width: '100%',
                        textAlign: 'center',
                        // borderBottom: '1px solid var(--text-color)'
                    }}
                >{`${currentText ? currentText : placeholder}`}</div>
                <div className={'editable-input-buttons'}>
                    <svg
                        style={{
                            height: '100%'
                        }}
                        onClick={() => setEditing(true)}
                        xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 32 32">
                        <path d="M 20.96875 3.9160156 C 19.778811 3.9206328 18.52575 4.2457344 17.296875 5.0058594 C 16.964283 5.211704 16.635788 5.4265814 16.310547 5.6445312 C 16.310093 5.6448354 16.309048 5.6442271 16.308594 5.6445312 A 0.287 0.287 0 0 0 16.335938 6.1816406 C 16.341365 6.1853565 16.343925 6.1941909 16.349609 6.1972656 C 20.381609 8.3782656 23.658219 11.669891 25.824219 15.712891 A 0.287 0.287 0 0 0 26.085938 15.880859 A 0.287 0.287 0 0 0 26.349609 15.699219 A 0.287 0.287 0 0 0 26.351562 15.697266 C 26.57166 15.37011 26.787062 15.039663 26.994141 14.705078 C 29.021141 11.426078 27.947375 7.978625 25.984375 6.015625 C 24.758125 4.78875 22.951982 3.9083203 20.96875 3.9160156 z M 14.058594 7.4492188 C 13.871844 7.4707187 13.690063 7.5430625 13.539062 7.6640625 C 12.562062 8.4470625 11.623469 9.2772969 10.730469 10.154297 C 6.3334687 14.476297 3.8931094 20.542734 4.0371094 26.802734 C 4.0561094 27.437734 4.5661719 27.947891 5.2011719 27.962891 C 5.3771719 27.966891 5.5506094 27.96875 5.7246094 27.96875 C 11.793609 27.96875 17.643703 25.542578 21.845703 21.267578 C 22.719703 20.377578 23.548125 19.44175 24.328125 18.46875 C 24.571125 18.16875 24.620172 17.745437 24.451172 17.398438 C 22.355172 13.092437 18.912328 9.6459687 14.611328 7.5429688 C 14.437328 7.4579688 14.245344 7.4277188 14.058594 7.4492188 z M 7.78125 18.792969 C 7.8554844 18.779438 7.9327656 18.779422 8.0097656 18.794922 C 10.617766 19.323922 12.676078 21.382234 13.205078 23.990234 C 13.268078 24.297234 13.078203 24.609797 12.783203 24.716797 C 10.854203 25.413797 8.8202344 25.838359 6.7402344 25.943359 C 6.3602344 25.962359 6.0376406 25.639766 6.0566406 25.259766 C 6.1606406 23.179766 6.5862031 21.144797 7.2832031 19.216797 C 7.3634531 18.994797 7.5585469 18.833563 7.78125 18.792969 z"></path>
                    </svg>
                </div>
            </>
        }
    </div>

}

export default EditableTextInput;
